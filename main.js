(()=>{"use strict";class e{constructor(e){this.length=e,this.hits=0,this.sunk=!1}get length(){return this._length}set length(e){this._length=e}hit(){this.hits+=1,this.isSunk()}isSunk(){this.hits==this.length&&(this.sunk=!0)}}class t{constructor(){this.board=[new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1})))],this.ships=[]}resetBoard(){this.board=[new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1})))],this.ships=[]}placeShip(t,i,l,r){if(0==r){for(let e=i;e<i+l;e++)if(null==this.board[t][e]||null!=this.board[t][e].ship)return!1;let r=new e(l);this.ships.push(r);for(let e=i;e<i+l;e++)this.board[t][e].ship=r;return!0}if(1==r){for(let e=t;e<t+l;e++)if(null==this.board[e]||null!=this.board[e][i].ship)return!1;let r=new e(l);this.ships.push(r);for(let e=t;e<t+l;e++)this.board[e][i].ship=r;return!0}}receiveAttack(e,t){null!=this.board[e][t].ship?(this.board[e][t].ship.hit(),this.board[e][t].isHit=!0):null==this.board[e][t].ship&&(this.board[e][t].isHit=!0)}allShipsSunk(){if(this.ships.every((e=>1==e.sunk)))return!0}}class i{constructor(){this.gameboard=new t}takeTurn(e,t,i){e.receiveAttack(t,i)}}let l=new i,r=new class extends i{generateCoord(){return Math.floor(10*Math.random())}takeTurnAI(e){let t=0,i=0,l=!0;for(;l;)t=this.generateCoord(),i=this.generateCoord(),0==e.board[t][i].isHit&&(e.receiveAttack(t,i),l=!1)}placeRandomShip(e){let t=0,i=0,l=Math.random()>.5,r=!0;for(;r;)t=this.generateCoord(),i=this.generateCoord(),this.gameboard.placeShip(t,i,e,l)&&(r=!1)}},a=document.querySelector(".new-round");function n(e){let t=e.target.id,i=Number(t[0]),s=Number(t[1]);0==r.gameboard.board[i][s].isHit&&(l.takeTurn(r.gameboard,i,s),m(),r.takeTurnAI(l.gameboard),p(),function(){let e=Array.from(document.querySelectorAll(".computer-grid > div")),t=document.querySelector(".winner-text > h1");r.gameboard.allShipsSunk()?(t.textContent="You Win!",e.forEach((e=>{e.removeEventListener("click",n)})),a.style.display="block"):l.gameboard.allShipsSunk()&&(t.textContent="You Lose!",e.forEach((e=>{e.removeEventListener("click",n)})),a.style.display="block")}())}let s=document.querySelector(".human-grid"),o=document.querySelector(".computer-grid"),d=document.querySelector(".new-round"),u=document.querySelector(".winner-text > h1"),h=!1,c=document.querySelector(".switch");function p(){b(s);for(let e=0;e<10;e++)for(let t=0;t<10;t++)if(null==l.gameboard.board[e][t].ship&&0==l.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square"),i.setAttribute("id",e.toString()+t.toString()),s.appendChild(i)}else if(null!=l.gameboard.board[e][t].ship&&0==l.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship"),i.setAttribute("id",e.toString()+t.toString()),s.appendChild(i)}else if(null==l.gameboard.board[e][t].ship&&1==l.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-hit"),i.setAttribute("id",e.toString()+t.toString()),s.appendChild(i)}else if(null!=l.gameboard.board[e][t].ship&&1==l.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship-hit"),i.setAttribute("id",e.toString()+t.toString()),s.appendChild(i)}!function(){let e=document.querySelectorAll(".human-grid > .square");0==l.gameboard.ships.length&&(u.textContent="Place your Carrier!"),e.forEach((e=>{l.gameboard.ships.length<5&&e.classList.add("hover"),e.addEventListener("click",(function(e){let t=e.target.id,i=Number(t[0]),a=Number(t[1]);0==l.gameboard.ships.length?l.gameboard.placeShip(i,a,5,h)&&(p(),u.textContent="Place your Battleship!"):1==l.gameboard.ships.length?l.gameboard.placeShip(i,a,4,h)&&(p(),u.textContent="Place your Cruiser!"):2==l.gameboard.ships.length?l.gameboard.placeShip(i,a,3,h)&&(p(),u.textContent="Place your Submarine!"):3==l.gameboard.ships.length?l.gameboard.placeShip(i,a,3,h)&&(p(),u.textContent="Place your Destroyer!"):4==l.gameboard.ships.length&&l.gameboard.placeShip(i,a,2,h)&&(p(),document.querySelector(".human-label").textContent="YOU",document.querySelector(".computer-label").textContent="YOUR ENEMY",document.querySelector(".winner-text > h1").textContent="",document.querySelector(".switch").style.display="none",r.placeRandomShip(5),r.placeRandomShip(4),r.placeRandomShip(3),r.placeRandomShip(3),r.placeRandomShip(2),m())}))}))}()}function m(){b(o);for(let e=0;e<10;e++)for(let t=0;t<10;t++)if(null==r.gameboard.board[e][t].ship&&0==r.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square"),i.setAttribute("id",e.toString()+t.toString()),o.appendChild(i)}else if(null!=r.gameboard.board[e][t].ship&&0==r.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square"),i.setAttribute("id",e.toString()+t.toString()),o.appendChild(i)}else if(null==r.gameboard.board[e][t].ship&&1==r.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-hit"),i.setAttribute("id",e.toString()+t.toString()),o.appendChild(i)}else if(null!=r.gameboard.board[e][t].ship&&1==r.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship-hit"),i.setAttribute("id",e.toString()+t.toString()),o.appendChild(i)}Array.from(document.querySelectorAll(".computer-grid > div")).forEach((e=>{e.addEventListener("click",n)}))}function b(e){for(;e.firstChild;)e.removeChild(e.firstChild)}c.addEventListener("click",(function(e){0==h?(h=!0,c.textContent="Rotate Horizontally"):1==h&&(h=!1,c.textContent="Rotate Vertically")})),d.addEventListener("click",(function(e){l.gameboard.resetBoard(),r.gameboard.resetBoard(),b(o),u.textContent="",d.style.display="none",document.querySelector(".human-label").textContent="",document.querySelector(".computer-label").textContent="",document.querySelector(".switch").style.display="block",p()})),p()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YixhQUNuQm9ELEVBQVdGLEdBQ1hULEVBQVdDLFlBQWMsR0FDekIsRUFBU0ksTUFBTUMsUUFBVSxPQUN6QnJCLFNBQVNDLGNBQWMsZ0JBQWdCZSxZQUFjLEdBQ3JEaEIsU0FBU0MsY0FBYyxtQkFBbUJlLFlBQWMsR0FDeERoQixTQUFTQyxjQUFjLFdBQVdtQixNQUFNQyxRQUFVLFFBQ2xEVixPQ3JLSkEsSyIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVDb250cm9sbGVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvYWkuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9kb20uanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgU2hpcCB7XG4gICAgY29uc3RydWN0b3IobGVuZ3RoKSB7XG4gICAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgICB0aGlzLmhpdHMgPSAwO1xuICAgICAgICB0aGlzLnN1bmsgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBnZXQgbGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGVuZ3RoO1xuICAgIH1cblxuICAgIHNldCBsZW5ndGgobGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuX2xlbmd0aCA9IGxlbmd0aDtcbiAgICB9XG5cbiAgICBoaXQoKSB7XG4gICAgICAgIHRoaXMuaGl0cyArPSAxO1xuICAgICAgICB0aGlzLmlzU3VuaygpO1xuICAgIH1cblxuICAgIGlzU3VuaygpIHtcbiAgICAgICAgaWYodGhpcy5oaXRzID09IHRoaXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnN1bmsgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcblxuZXhwb3J0IGNsYXNzIEdhbWVib2FyZCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpXG4gICAgICAgIF1cblxuICAgICAgICB0aGlzLnNoaXBzID0gW11cbiAgICB9XG5cbiAgICByZXNldEJvYXJkKCkge1xuICAgICAgICB0aGlzLmJvYXJkID0gW1xuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKVxuICAgICAgICBdXG5cbiAgICAgICAgdGhpcy5zaGlwcyA9IFtdXG4gICAgfVxuXG4gICAgcGxhY2VTaGlwKHhQb3MsIHlQb3MsIGxlbmd0aCwgaXNWZXJ0aWNhbCkgeyAgXG4gICAgICAgIGlmKGlzVmVydGljYWwgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIC8vaG9yaXpvbnRhbCBzaGlwXG4gICAgICAgICAgICBmb3IobGV0IGkgPSB5UG9zOyBpIDwgeVBvcyArIGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYodGhpcy5ib2FyZFt4UG9zXVtpXSA9PSB1bmRlZmluZWQgfHwgdGhpcy5ib2FyZFt4UG9zXVtpXS5zaGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jaGVjayBpZiBBTEwgdGhlIHNwb3RzIGFyZSBnb29kIGJlZm9yZSBwdXR0aW5nIGRvd24gdGhlIHNoaXBcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBhbnkgb2YgdGhlIHNwb3RzIGhhdmUgYmVlbiB0YWtlbiBieSBhbm90aGVyIHNoaXAsIHdlIGNhbm5vdCBwdXQgYSBuZXcgc2hpcCB0aGVyZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9tYWtlIHRoZSBzaGlwIFxuICAgICAgICAgICAgbGV0IG5ld1NoaXAgPSBuZXcgU2hpcChsZW5ndGgpO1xuICAgICAgICAgICAgdGhpcy5zaGlwcy5wdXNoKG5ld1NoaXApO1xuICAgICAgICAgICAgZm9yKGxldCBpID0geVBvczsgaSA8IHlQb3MgKyBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIC8vd2Uga25vdyB0aGUgc3BvdHMgaGF2ZSBiZWVuIGNoZWNrZWQsIHNvIHdlIGNhbiBwdXQgdGhlIHNoaXAgaW4gdGhvc2Ugc3BvdHNcbiAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW3hQb3NdW2ldLnNoaXAgPSBuZXdTaGlwOyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoaXNWZXJ0aWNhbCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAvL3ZlcnRpY2FsIHNoaXBcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IHhQb3M7IGkgPCB4UG9zICsgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZih0aGlzLmJvYXJkW2ldID09IHVuZGVmaW5lZCB8fCB0aGlzLmJvYXJkW2ldW3lQb3NdLnNoaXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIEFMTCB0aGUgc3BvdHMgYXJlIGdvb2QgYmVmb3JlIHB1dHRpbmcgZG93biB0aGUgc2hpcFxuICAgICAgICAgICAgICAgICAgICAvL2lmIGFueSBvZiB0aGUgc3BvdHMgaGF2ZSBiZWVuIHRha2VuIGJ5IGFub3RoZXIgc2hpcCwgd2UgY2Fubm90IHB1dCBhIG5ldyBzaGlwIHRoZXJlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL21ha2UgdGhlIHNoaXAgXG4gICAgICAgICAgICBsZXQgbmV3U2hpcCA9IG5ldyBTaGlwKGxlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLnNoaXBzLnB1c2gobmV3U2hpcCk7XG4gICAgICAgICAgICBmb3IobGV0IGkgPSB4UG9zOyBpIDwgeFBvcyArIGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgLy93ZSBrbm93IHRoZSBzcG90cyBoYXZlIGJlZW4gY2hlY2tlZCwgc28gd2UgY2FuIHB1dCB0aGUgc2hpcCBpbiB0aG9zZSBzcG90c1xuICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbaV1beVBvc10uc2hpcCA9IG5ld1NoaXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlY2VpdmVBdHRhY2soeFBvcywgeVBvcykge1xuICAgICAgICAvL2lmIHRoZSBzcXVhcmUgaGFzIGEgc2hpcCBvbiBpdFxuICAgICAgICBpZih0aGlzLmJvYXJkW3hQb3NdW3lQb3NdLnNoaXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5ib2FyZFt4UG9zXVt5UG9zXS5zaGlwLmhpdCgpO1xuICAgICAgICAgICAgdGhpcy5ib2FyZFt4UG9zXVt5UG9zXS5pc0hpdCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy9pZiB0aGVyZSBzcXVhcmUgZG9lcyBub3QgaGF2ZSBhIHNoaXAgb24gaXRcbiAgICAgICAgZWxzZSBpZih0aGlzLmJvYXJkW3hQb3NdW3lQb3NdLnNoaXAgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5ib2FyZFt4UG9zXVt5UG9zXS5pc0hpdCA9IHRydWU7ICAgXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhbGxTaGlwc1N1bmsoKSB7XG4gICAgICAgIGlmKHRoaXMuc2hpcHMuZXZlcnkoc2hpcCA9PiBzaGlwLnN1bmsgPT0gdHJ1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxufSIsImltcG9ydCB7IEdhbWVib2FyZCB9IGZyb20gXCIuL2dhbWVib2FyZFwiO1xuXG5leHBvcnQgY2xhc3MgUGxheWVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5nYW1lYm9hcmQgPSBuZXcgR2FtZWJvYXJkO1xuICAgIH1cbiAgICBcbiAgICB0YWtlVHVybihlbmVteUdhbWVib2FyZCwgeFBvcywgeVBvcykge1xuICAgICAgICBlbmVteUdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKHhQb3MsIHlQb3MpOyBcbiAgICB9XG59IiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQgeyBBSSB9IGZyb20gXCIuL2FpXCI7XG5pbXBvcnQgeyBwb3B1bGF0ZUVuZW15Qm9hcmQsIHBvcHVsYXRlUGxheWVyQm9hcmQgfSBmcm9tIFwiLi9kb21cIjtcblxuZXhwb3J0IGxldCBodW1hbiA9IG5ldyBQbGF5ZXIoKTtcbmV4cG9ydCBsZXQgY29tcHV0ZXIgPSBuZXcgQUkoKTtcbmxldCBuZXdSb3VuZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXJvdW5kXCIpO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBjbGlja0hhbmRsZXIoZSkge1xuICAgIGxldCBjbGlja2VkID0gZS50YXJnZXQuaWQ7XG4gICAgbGV0IHggPSBOdW1iZXIoY2xpY2tlZFswXSk7XG4gICAgbGV0IHkgPSBOdW1iZXIoY2xpY2tlZFsxXSk7XG4gICAgaWYoY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW3hdW3ldLmlzSGl0ID09IGZhbHNlKSB7XG4gICAgICAgIGh1bWFuLnRha2VUdXJuKGNvbXB1dGVyLmdhbWVib2FyZCwgeCwgeSlcbiAgICAgICAgcG9wdWxhdGVFbmVteUJvYXJkKCk7XG4gICAgICAgIGNvbXB1dGVyLnRha2VUdXJuQUkoaHVtYW4uZ2FtZWJvYXJkKTtcbiAgICAgICAgcG9wdWxhdGVQbGF5ZXJCb2FyZCgpOyBcbiAgICAgICAgY2hlY2tGb3JXaW4oKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrRm9yV2luKCkge1xuICAgIGxldCBjb21wdXRlclNxdWFyZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29tcHV0ZXItZ3JpZCA+IGRpdlwiKSk7XG4gICAgbGV0IHdpbm5lclRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndpbm5lci10ZXh0ID4gaDFcIik7XG5cbiAgICBpZihjb21wdXRlci5nYW1lYm9hcmQuYWxsU2hpcHNTdW5rKCkpIHtcbiAgICAgICAgd2lubmVyVGV4dC50ZXh0Q29udGVudCA9IFwiWW91IFdpbiFcIlxuICAgICAgICBjb21wdXRlclNxdWFyZXMuZm9yRWFjaChzcXVhcmUgPT4ge1xuICAgICAgICAgICAgc3F1YXJlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbGlja0hhbmRsZXIpO1xuICAgICAgICB9KVxuICAgICAgICBuZXdSb3VuZC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIH1cbiAgICBlbHNlIGlmKGh1bWFuLmdhbWVib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xuICAgICAgICB3aW5uZXJUZXh0LnRleHRDb250ZW50ID0gXCJZb3UgTG9zZSFcIlxuICAgICAgICBjb21wdXRlclNxdWFyZXMuZm9yRWFjaChzcXVhcmUgPT4ge1xuICAgICAgICAgICAgc3F1YXJlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbGlja0hhbmRsZXIpO1xuICAgICAgICB9KVxuICAgICAgICBuZXdSb3VuZC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0R2FtZSgpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmh1bWFuLWxhYmVsXCIpLnRleHRDb250ZW50ID0gXCJZT1VcIjtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXB1dGVyLWxhYmVsXCIpLnRleHRDb250ZW50ID0gXCJZT1VSIEVORU1ZXCI7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aW5uZXItdGV4dCA+IGgxXCIpLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN3aXRjaFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICBjb21wdXRlci5wbGFjZVJhbmRvbVNoaXAoNSk7XG4gICAgY29tcHV0ZXIucGxhY2VSYW5kb21TaGlwKDQpO1xuICAgIGNvbXB1dGVyLnBsYWNlUmFuZG9tU2hpcCgzKTtcbiAgICBjb21wdXRlci5wbGFjZVJhbmRvbVNoaXAoMyk7XG4gICAgY29tcHV0ZXIucGxhY2VSYW5kb21TaGlwKDIpO1xuICAgIFxuICAgIHBvcHVsYXRlRW5lbXlCb2FyZCgpO1xufSIsImltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuXG5leHBvcnQgY2xhc3MgQUkgZXh0ZW5kcyBQbGF5ZXIge1xuXG4gICAgZ2VuZXJhdGVDb29yZCgpIHtcbiAgICAgICAgLy9yYW5kb20gbnVtYmVyIGJldHdlZW4gMCBhbmQgOVxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIH1cblxuICAgIHRha2VUdXJuQUkoZW5lbXlHYW1lYm9hcmQpIHtcbiAgICAgICAgbGV0IHhQb3MgPSAwO1xuICAgICAgICBsZXQgeVBvcyA9IDA7XG4gICAgICAgIGxldCBrZWVwR29pbmcgPSB0cnVlO1xuXG4gICAgICAgIHdoaWxlKGtlZXBHb2luZykge1xuICAgICAgICAgICAgeFBvcyA9IHRoaXMuZ2VuZXJhdGVDb29yZCgpO1xuICAgICAgICAgICAgeVBvcyA9IHRoaXMuZ2VuZXJhdGVDb29yZCgpO1xuICAgICAgICAgICAgaWYoZW5lbXlHYW1lYm9hcmQuYm9hcmRbeFBvc11beVBvc10uaXNIaXQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBlbmVteUdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKHhQb3MsIHlQb3MpO1xuICAgICAgICAgICAgICAgIGtlZXBHb2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcGxhY2VSYW5kb21TaGlwKGxlbmd0aCkge1xuICAgICAgICBsZXQgeFBvcyA9IDBcbiAgICAgICAgbGV0IHlQb3MgPSAwXG4gICAgICAgIGxldCBpc1ZlcnRpY2FsID0gTWF0aC5yYW5kb20oKSA+IDAuNSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgbGV0IGtlZXBHb2luZyA9IHRydWU7XG5cbiAgICAgICAgd2hpbGUoa2VlcEdvaW5nKSB7XG4gICAgICAgICAgICB4UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICB5UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICBpZih0aGlzLmdhbWVib2FyZC5wbGFjZVNoaXAoeFBvcywgeVBvcywgbGVuZ3RoLCBpc1ZlcnRpY2FsKSkge1xuICAgICAgICAgICAgICAgIGtlZXBHb2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cbn0iLCJpbXBvcnQgeyBodW1hbiwgY29tcHV0ZXIsIGNsaWNrSGFuZGxlciwgc3RhcnRHYW1lIH0gZnJvbSBcIi4vZ2FtZUNvbnRyb2xsZXJcIjtcblxubGV0IGh1bWFuR3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaHVtYW4tZ3JpZFwiKTtcbmxldCBjb21wdXRlckdyaWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXB1dGVyLWdyaWRcIik7XG5sZXQgbmV3Um91bmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm5ldy1yb3VuZFwiKTtcbmxldCB3aW5uZXJUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aW5uZXItdGV4dCA+IGgxXCIpO1xuXG5sZXQgaXNWZXJ0aWNhbCA9IGZhbHNlO1xuXG5sZXQgc3dpdGNoQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zd2l0Y2hcIik7XG5zd2l0Y2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICBpZihpc1ZlcnRpY2FsID09IGZhbHNlKSB7XG4gICAgICAgIGlzVmVydGljYWwgPSB0cnVlO1xuICAgICAgICBzd2l0Y2hCdXR0b24udGV4dENvbnRlbnQgPSBcIlJvdGF0ZSBIb3Jpem9udGFsbHlcIlxuICAgIH1cbiAgICBlbHNlIGlmKGlzVmVydGljYWwgPT0gdHJ1ZSkge1xuICAgICAgICBpc1ZlcnRpY2FsID0gZmFsc2U7XG4gICAgICAgIHN3aXRjaEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiUm90YXRlIFZlcnRpY2FsbHlcIlxuICAgIH1cbn0pXG5cbmV4cG9ydCBmdW5jdGlvbiBwb3B1bGF0ZVBsYXllckJvYXJkKCkge1xuICAgIGNsZWFyQm9hcmQoaHVtYW5HcmlkKTtcblxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgICAgICAvL25vIHNoaXAgbm8gaGl0XG4gICAgICAgICAgICBpZihodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCA9PSBudWxsICYmIGh1bWFuLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlXCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGh1bWFuR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpOyAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy95ZXMgc2hpcCBubyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoaHVtYW4uZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgIT0gbnVsbCAmJiBodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZS1zaGlwXCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGh1bWFuR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9ubyBzaGlwIHllcyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoaHVtYW4uZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgPT0gbnVsbCAmJiBodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlLWhpdFwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgaS50b1N0cmluZygpICsgai50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBodW1hbkdyaWQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8veWVzIHNoaXAgeWVzIGhpdFxuICAgICAgICAgICAgZWxzZSBpZihodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCAhPSBudWxsICYmIGh1bWFuLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmUtc2hpcC1oaXRcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImlkXCIsIGkudG9TdHJpbmcoKSArIGoudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgaHVtYW5HcmlkLmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnYW1lU2V0dXAoKTtcbn1cblxuZnVuY3Rpb24gZ2FtZVNldHVwKCkge1xuICAgIC8vY2xpY2sgaGFuZGxlciBmb3IgcGxhY2luZyBzaGlwcyBiZWZvcmUgdGhlIGdhbWUgc3RhcnRzXG4gICAgbGV0IGh1bWFuU3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaHVtYW4tZ3JpZCA+IC5zcXVhcmVcIik7XG4gICAgaWYoaHVtYW4uZ2FtZWJvYXJkLnNoaXBzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIHdpbm5lclRleHQudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgQ2FycmllciFcIjsgXG4gICAgfVxuICAgIGh1bWFuU3F1YXJlcy5mb3JFYWNoKHNxdWFyZSA9PiB7XG4gICAgICAgICAgICBpZihodW1hbi5nYW1lYm9hcmQuc2hpcHMubGVuZ3RoIDwgNSkge1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiaG92ZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgbGV0IGNsaWNrZWQgPSBlLnRhcmdldC5pZDtcbiAgICAgICAgICAgIGxldCB4ID0gTnVtYmVyKGNsaWNrZWRbMF0pO1xuICAgICAgICAgICAgbGV0IHkgPSBOdW1iZXIoY2xpY2tlZFsxXSk7XG4gICAgICAgICAgICBpZihodW1hbi5nYW1lYm9hcmQuc2hpcHMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICBpZihodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKHgsIHksIDUsIGlzVmVydGljYWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvcHVsYXRlUGxheWVyQm9hcmQoKTtcbiAgICAgICAgICAgICAgICAgICAgd2lubmVyVGV4dC50ZXh0Q29udGVudCA9IFwiUGxhY2UgeW91ciBCYXR0bGVzaGlwIVwiO1xuICAgICAgICAgICAgICAgIH0gIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihodW1hbi5nYW1lYm9hcmQuc2hpcHMubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICBpZihodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKHgsIHksIDQsIGlzVmVydGljYWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvcHVsYXRlUGxheWVyQm9hcmQoKTtcbiAgICAgICAgICAgICAgICAgICAgd2lubmVyVGV4dC50ZXh0Q29udGVudCA9IFwiUGxhY2UgeW91ciBDcnVpc2VyIVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoaHVtYW4uZ2FtZWJvYXJkLnNoaXBzLmxlbmd0aCA9PSAyKSB7XG4gICAgICAgICAgICAgICAgaWYoaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcCh4LCB5LCAzLCBpc1ZlcnRpY2FsKSkge1xuICAgICAgICAgICAgICAgICAgICBwb3B1bGF0ZVBsYXllckJvYXJkKCk7XG4gICAgICAgICAgICAgICAgICAgIHdpbm5lclRleHQudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgU3VibWFyaW5lIVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoaHVtYW4uZ2FtZWJvYXJkLnNoaXBzLmxlbmd0aCA9PSAzKSB7XG4gICAgICAgICAgICAgICAgaWYoaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcCh4LCB5LCAzLCBpc1ZlcnRpY2FsKSkge1xuICAgICAgICAgICAgICAgICAgICBwb3B1bGF0ZVBsYXllckJvYXJkKCk7XG4gICAgICAgICAgICAgICAgICAgIHdpbm5lclRleHQudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgRGVzdHJveWVyIVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoaHVtYW4uZ2FtZWJvYXJkLnNoaXBzLmxlbmd0aCA9PSA0KSB7XG4gICAgICAgICAgICAgICAgaWYoaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcCh4LCB5LCAyLCBpc1ZlcnRpY2FsKSkge1xuICAgICAgICAgICAgICAgICAgICBwb3B1bGF0ZVBsYXllckJvYXJkKCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0R2FtZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcG9wdWxhdGVFbmVteUJvYXJkKCkge1xuICAgIGNsZWFyQm9hcmQoY29tcHV0ZXJHcmlkKTtcblxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgICAgICAvL25vIHNoaXAgbm8gaGl0XG4gICAgICAgICAgICBpZihjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCA9PSBudWxsICYmIGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlXCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGNvbXB1dGVyR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpOyAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy95ZXMgc2hpcCBubyBoaXQgXG4gICAgICAgICAgICAvL2NvbXB1dGVyIHNoaXAgbXVzdCBiZSBpbnZpc2libGUgdG8gdGhlIGh1bWFuIHBsYXllciBiZWZvcmUgYmVpbmcgaGl0XG4gICAgICAgICAgICBlbHNlIGlmKGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5zaGlwICE9IG51bGwgJiYgY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLmlzSGl0ID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImlkXCIsIGkudG9TdHJpbmcoKSArIGoudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgY29tcHV0ZXJHcmlkLmFwcGVuZENoaWxkKHNxdWFyZSk7IFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9ubyBzaGlwIHllcyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgPT0gbnVsbCAmJiBjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlLWhpdFwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgaS50b1N0cmluZygpICsgai50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBjb21wdXRlckdyaWQuYXBwZW5kQ2hpbGQoc3F1YXJlKTsgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3llcyBzaGlwIHllcyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgIT0gbnVsbCAmJiBjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlLXNoaXAtaGl0XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGNvbXB1dGVyR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpOyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxldCBjb21wdXRlclNxdWFyZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29tcHV0ZXItZ3JpZCA+IGRpdlwiKSk7XG5cbiAgICBjb21wdXRlclNxdWFyZXMuZm9yRWFjaChzcXVhcmUgPT4ge1xuICAgICAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrSGFuZGxlcik7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gY2xlYXJCb2FyZChib2FyZCkge1xuICAgIHdoaWxlKGJvYXJkLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgYm9hcmQucmVtb3ZlQ2hpbGQoYm9hcmQuZmlyc3RDaGlsZCk7XG4gICAgfVxufVxuXG5uZXdSb3VuZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuICAgIGh1bWFuLmdhbWVib2FyZC5yZXNldEJvYXJkKCk7XG4gICAgY29tcHV0ZXIuZ2FtZWJvYXJkLnJlc2V0Qm9hcmQoKTtcbiAgICBjbGVhckJvYXJkKGNvbXB1dGVyR3JpZCk7XG4gICAgd2lubmVyVGV4dC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgbmV3Um91bmQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaHVtYW4tbGFiZWxcIikudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcHV0ZXItbGFiZWxcIikudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3dpdGNoXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgcG9wdWxhdGVQbGF5ZXJCb2FyZCgpO1xufSlcbiIsImltcG9ydCB7IHBvcHVsYXRlUGxheWVyQm9hcmQgfSBmcm9tIFwiLi9kb21cIjtcblxucG9wdWxhdGVQbGF5ZXJCb2FyZCgpO1xuIl0sIm5hbWVzIjpbIlNoaXAiLCJjb25zdHJ1Y3RvciIsImxlbmd0aCIsInRoaXMiLCJoaXRzIiwic3VuayIsIl9sZW5ndGgiLCJoaXQiLCJpc1N1bmsiLCJHYW1lYm9hcmQiLCJib2FyZCIsIkFycmF5IiwiZmlsbCIsIm1hcCIsInNoaXAiLCJpc0hpdCIsInNoaXBzIiwicmVzZXRCb2FyZCIsInBsYWNlU2hpcCIsInhQb3MiLCJ5UG9zIiwiaXNWZXJ0aWNhbCIsImkiLCJ1bmRlZmluZWQiLCJuZXdTaGlwIiwicHVzaCIsInJlY2VpdmVBdHRhY2siLCJhbGxTaGlwc1N1bmsiLCJldmVyeSIsIlBsYXllciIsImdhbWVib2FyZCIsInRha2VUdXJuIiwiZW5lbXlHYW1lYm9hcmQiLCJodW1hbiIsImNvbXB1dGVyIiwiZ2VuZXJhdGVDb29yZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInRha2VUdXJuQUkiLCJrZWVwR29pbmciLCJwbGFjZVJhbmRvbVNoaXAiLCJuZXdSb3VuZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNsaWNrSGFuZGxlciIsImUiLCJjbGlja2VkIiwidGFyZ2V0IiwiaWQiLCJ4IiwiTnVtYmVyIiwieSIsInBvcHVsYXRlRW5lbXlCb2FyZCIsInBvcHVsYXRlUGxheWVyQm9hcmQiLCJjb21wdXRlclNxdWFyZXMiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIndpbm5lclRleHQiLCJ0ZXh0Q29udGVudCIsImZvckVhY2giLCJzcXVhcmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic3R5bGUiLCJkaXNwbGF5IiwiY2hlY2tGb3JXaW4iLCJodW1hbkdyaWQiLCJjb21wdXRlckdyaWQiLCJzd2l0Y2hCdXR0b24iLCJjbGVhckJvYXJkIiwiaiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJ0b1N0cmluZyIsImFwcGVuZENoaWxkIiwiaHVtYW5TcXVhcmVzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdhbWVTZXR1cCIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCJdLCJzb3VyY2VSb290IjoiIn0=