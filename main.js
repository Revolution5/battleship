(()=>{"use strict";class e{constructor(e){this.length=e,this.hits=0,this.sunk=!1}get length(){return this._length}set length(e){this._length=e}hit(){this.hits+=1,this.isSunk()}isSunk(){this.hits==this.length&&(this.sunk=!0)}}class t{constructor(){this.board=[new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1})))],this.ships=[]}resetBoard(){this.board=[new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1})))],this.ships=[]}placeShip(t,i,l){if(null==this.board[t][i].ship){let r=new e(l);for(let e=i;e<i+l;e++)null==this.board[t][e].ship&&(this.board[t][e].ship=r);this.ships.push(r)}}receiveAttack(e,t){null!=this.board[e][t].ship?(this.board[e][t].ship.hit(),this.board[e][t].isHit=!0):null==this.board[e][t].ship&&(this.board[e][t].isHit=!0)}allShipsSunk(){if(this.ships.every((e=>1==e.sunk)))return!0}}class i{constructor(){this.gameboard=new t}generateCoord(){return Math.floor(10*Math.random())}takeTurn(e,t,i){e.receiveAttack(t,i)}takeTurnAI(e){let t=0,i=0,l=!0;for(;l;)t=this.generateCoord(),i=this.generateCoord(),0==e.board[t][i].isHit&&(e.receiveAttack(t,i),l=!1)}}let l=document.querySelector(".human-grid"),r=document.querySelector(".computer-grid"),a=document.querySelector(".new-round"),n=document.querySelector(".winner-text > h1");function s(){d(l);for(let e=0;e<10;e++)for(let t=0;t<10;t++)if(null==u.gameboard.board[e][t].ship&&0==u.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square"),i.setAttribute("id",e.toString()+t.toString()),l.appendChild(i)}else if(null!=u.gameboard.board[e][t].ship&&0==u.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship"),i.setAttribute("id",e.toString()+t.toString()),l.appendChild(i)}else if(null==u.gameboard.board[e][t].ship&&1==u.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-hit"),i.setAttribute("id",e.toString()+t.toString()),l.appendChild(i)}else if(null!=u.gameboard.board[e][t].ship&&1==u.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship-hit"),i.setAttribute("id",e.toString()+t.toString()),l.appendChild(i)}}function o(){d(r);for(let e=0;e<10;e++)for(let t=0;t<10;t++)if(null==h.gameboard.board[e][t].ship&&0==h.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square"),i.setAttribute("id",e.toString()+t.toString()),r.appendChild(i)}else if(null!=h.gameboard.board[e][t].ship&&0==h.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship"),i.setAttribute("id",e.toString()+t.toString()),r.appendChild(i)}else if(null==h.gameboard.board[e][t].ship&&1==h.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-hit"),i.setAttribute("id",e.toString()+t.toString()),r.appendChild(i)}else if(null!=h.gameboard.board[e][t].ship&&1==h.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship-hit"),i.setAttribute("id",e.toString()+t.toString()),r.appendChild(i)}Array.from(document.querySelectorAll(".computer-grid > div")).forEach((e=>{e.addEventListener("click",c)}))}function d(e){for(;e.firstChild;)e.removeChild(e.firstChild)}a.addEventListener("click",(function(e){n.textContent="",m()}));let u=new i,h=new class extends i{generateCoord(){return Math.floor(10*Math.random())}takeTurnAI(e){let t=0,i=0,l=!0;for(;l;)t=this.generateCoord(),i=this.generateCoord(),0==e.board[t][i].isHit&&(e.receiveAttack(t,i),l=!1)}placeRandomShip(e){let t=0,i=0,l=!0;for(;l;)t=this.generateCoord(),i=this.generateCoord(),this.gameboard.placeShip(t,i,e)&&(l=!1)}},p=document.querySelector(".new-round");function c(e){let t=e.target.id,i=t[0],l=t[1];0==h.gameboard.board[i][l].isHit&&(u.takeTurn(h.gameboard,i,l),o(),h.takeTurnAI(u.gameboard),s(),function(){let e=Array.from(document.querySelectorAll(".computer-grid > div")),t=document.querySelector(".winner-text > h1");h.gameboard.allShipsSunk()?(t.textContent="You Win!",e.forEach((e=>{e.removeEventListener("click",c)})),p.style.display="block"):u.gameboard.allShipsSunk()&&(t.textContent="You Lose!",e.forEach((e=>{e.removeEventListener("click",c)})),p.style.display="block")}())}function m(){u.gameboard.resetBoard(),h.gameboard.resetBoard(),p.style.display="none",u.gameboard.placeShip(2,3,5),u.gameboard.placeShip(0,1,4),u.gameboard.placeShip(4,4,3),u.gameboard.placeShip(6,7,3),u.gameboard.placeShip(8,1,2),h.placeRandomShip(5),h.placeRandomShip(4),h.placeRandomShip(3),h.placeRandomShip(3),h.placeRandomShip(2),s(),o()}m()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU00RCxHQUFHQyxHQUFHeEQsUUFDOUIrQixFQUFNYixTQUFTc0IsRUFBUzNCLFVBQVcwQyxFQUFHQyxHQUN0Q2pCLElBQ0FDLEVBQVNwQixXQUFXVyxFQUFNbEIsV0FDMUJlLElBS1IsV0FDSSxJQUFJNkIsRUFBa0I3RCxNQUFNNkMsS0FBS2xCLFNBQVNtQixpQkFBaUIseUJBQ3ZEZixFQUFhSixTQUFTQyxjQUFjLHFCQUVyQ2dCLEVBQVMzQixVQUFVSCxnQkFDbEJpQixFQUFXc0IsWUFBYyxXQUN6QlEsRUFBZ0JkLFNBQVFYLElBQ3BCQSxFQUFPMEIsb0JBQW9CLFFBQVNiLE1BRXhDLEVBQVNjLE1BQU1DLFFBQVUsU0FFckI3QixFQUFNbEIsVUFBVUgsaUJBQ3BCaUIsRUFBV3NCLFlBQWMsWUFDekJRLEVBQWdCZCxTQUFRWCxJQUNwQkEsRUFBTzBCLG9CQUFvQixRQUFTYixNQUV4QyxFQUFTYyxNQUFNQyxRQUFVLFNBcEJ6QkMsSUF3QkQsU0FBU1gsSUFDWm5CLEVBQU1sQixVQUFVWCxhQUNoQnNDLEVBQVMzQixVQUFVWCxhQUVuQixFQUFTeUQsTUFBTUMsUUFBVSxPQUV6QjdCLEVBQU1sQixVQUFVVixVQUFVLEVBQUUsRUFBRSxHQUM5QjRCLEVBQU1sQixVQUFVVixVQUFVLEVBQUUsRUFBRSxHQUM5QjRCLEVBQU1sQixVQUFVVixVQUFVLEVBQUUsRUFBRSxHQUM5QjRCLEVBQU1sQixVQUFVVixVQUFVLEVBQUUsRUFBRSxHQUM5QjRCLEVBQU1sQixVQUFVVixVQUFVLEVBQUUsRUFBRSxHQUU5QnFDLEVBQVNXLGdCQUFnQixHQUN6QlgsRUFBU1csZ0JBQWdCLEdBQ3pCWCxFQUFTVyxnQkFBZ0IsR0FDekJYLEVBQVNXLGdCQUFnQixHQUN6QlgsRUFBU1csZ0JBQWdCLEdBRXpCdkIsSUFDQVcsSUUxREpXLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9kb20uanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lQ29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2FpLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIFNoaXAge1xuICAgIGNvbnN0cnVjdG9yKGxlbmd0aCkge1xuICAgICAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcbiAgICAgICAgdGhpcy5oaXRzID0gMDtcbiAgICAgICAgdGhpcy5zdW5rID0gZmFsc2U7XG4gICAgfVxuXG4gICAgZ2V0IGxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlbmd0aDtcbiAgICB9XG5cbiAgICBzZXQgbGVuZ3RoKGxlbmd0aCkge1xuICAgICAgICB0aGlzLl9sZW5ndGggPSBsZW5ndGg7XG4gICAgfVxuXG4gICAgaGl0KCkge1xuICAgICAgICB0aGlzLmhpdHMgKz0gMTtcbiAgICAgICAgdGhpcy5pc1N1bmsoKTtcbiAgICB9XG5cbiAgICBpc1N1bmsoKSB7XG4gICAgICAgIGlmKHRoaXMuaGl0cyA9PSB0aGlzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5zdW5rID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5cbmV4cG9ydCBjbGFzcyBHYW1lYm9hcmQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmJvYXJkID0gW1xuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKVxuICAgICAgICBdXG5cbiAgICAgICAgdGhpcy5zaGlwcyA9IFtdXG4gICAgfVxuXG4gICAgcmVzZXRCb2FyZCgpIHtcbiAgICAgICAgdGhpcy5ib2FyZCA9IFtcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSlcbiAgICAgICAgXVxuXG4gICAgICAgIHRoaXMuc2hpcHMgPSBbXVxuICAgIH1cblxuICAgIHBsYWNlU2hpcCh4UG9zLCB5UG9zLCBsZW5ndGgpIHtcbiAgICAgICAgaWYodGhpcy5ib2FyZFt4UG9zXVt5UG9zXS5zaGlwID09IG51bGwpIHtcbiAgICAgICAgICAgIGxldCBuZXdTaGlwID0gbmV3IFNoaXAobGVuZ3RoKTtcbiAgICAgICAgICAgIC8vaG9yaXpvbnRhbCBzaGlwXG4gICAgICAgICAgICBmb3IobGV0IGkgPSB5UG9zOyBpIDwgeVBvcyArIGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYodGhpcy5ib2FyZFt4UG9zXVtpXS5zaGlwID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jaGVjayBpZiBBTEwgdGhlIHNwb3RzIGFyZSBnb29kIGJlZm9yZSBwdXR0aW5nIGRvd24gdGhlIHNoaXBcbiAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW3hQb3NdW2ldLnNoaXAgPSBuZXdTaGlwOyAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNoaXBzLnB1c2gobmV3U2hpcCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZWNlaXZlQXR0YWNrKHhQb3MsIHlQb3MpIHtcbiAgICAgICAgLy9pZiB0aGUgc3F1YXJlIGhhcyBhIHNoaXAgb24gaXRcbiAgICAgICAgaWYodGhpcy5ib2FyZFt4UG9zXVt5UG9zXS5zaGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuYm9hcmRbeFBvc11beVBvc10uc2hpcC5oaXQoKTtcbiAgICAgICAgICAgIHRoaXMuYm9hcmRbeFBvc11beVBvc10uaXNIaXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIC8vaWYgdGhlcmUgc3F1YXJlIGRvZXMgbm90IGhhdmUgYSBzaGlwIG9uIGl0XG4gICAgICAgIGVsc2UgaWYodGhpcy5ib2FyZFt4UG9zXVt5UG9zXS5zaGlwID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuYm9hcmRbeFBvc11beVBvc10uaXNIaXQgPSB0cnVlOyAgIFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWxsU2hpcHNTdW5rKCkge1xuICAgICAgICBpZih0aGlzLnNoaXBzLmV2ZXJ5KHNoaXAgPT4gc2hpcC5zdW5rID09IHRydWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCJpbXBvcnQgeyBHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuZXhwb3J0IGNsYXNzIFBsYXllciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZ2FtZWJvYXJkID0gbmV3IEdhbWVib2FyZDtcbiAgICB9XG5cbiAgICBnZW5lcmF0ZUNvb3JkKCkge1xuICAgICAgICAvL3JhbmRvbSBudW1iZXIgYmV0d2VlbiAwIGFuZCA5XG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgfVxuXG4gICAgdGFrZVR1cm4oZW5lbXlHYW1lYm9hcmQsIHhQb3MsIHlQb3MpIHtcbiAgICAgICAgZW5lbXlHYW1lYm9hcmQucmVjZWl2ZUF0dGFjayh4UG9zLCB5UG9zKTsgXG4gICAgfVxuXG4gICAgdGFrZVR1cm5BSShlbmVteUdhbWVib2FyZCkge1xuICAgICAgICBsZXQgeFBvcyA9IDA7XG4gICAgICAgIGxldCB5UG9zID0gMDtcbiAgICAgICAgbGV0IGtlZXBHb2luZyA9IHRydWU7XG5cbiAgICAgICAgd2hpbGUoa2VlcEdvaW5nKSB7XG4gICAgICAgICAgICB4UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICB5UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICBpZihlbmVteUdhbWVib2FyZC5ib2FyZFt4UG9zXVt5UG9zXS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGVuZW15R2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soeFBvcywgeVBvcyk7XG4gICAgICAgICAgICAgICAga2VlcEdvaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59IiwiaW1wb3J0IHsgaHVtYW4sIGNvbXB1dGVyLCBjbGlja0hhbmRsZXIsIHN0YXJ0R2FtZSB9IGZyb20gXCIuL2dhbWVDb250cm9sbGVyXCI7XG5cbmxldCBodW1hbkdyaWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmh1bWFuLWdyaWRcIik7XG5sZXQgY29tcHV0ZXJHcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wdXRlci1ncmlkXCIpO1xubGV0IG5ld1JvdW5kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXctcm91bmRcIik7XG5sZXQgd2lubmVyVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2lubmVyLXRleHQgPiBoMVwiKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHBvcHVsYXRlUGxheWVyQm9hcmQoKSB7XG4gICAgY2xlYXJCb2FyZChodW1hbkdyaWQpO1xuXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgICAgIC8vbm8gc2hpcCBubyBoaXRcbiAgICAgICAgICAgIGlmKGh1bWFuLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5zaGlwID09IG51bGwgJiYgaHVtYW4uZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLmlzSGl0ID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImlkXCIsIGkudG9TdHJpbmcoKSArIGoudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgaHVtYW5HcmlkLmFwcGVuZENoaWxkKHNxdWFyZSk7ICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3llcyBzaGlwIG5vIGhpdFxuICAgICAgICAgICAgZWxzZSBpZihodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCAhPSBudWxsICYmIGh1bWFuLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlLXNoaXBcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImlkXCIsIGkudG9TdHJpbmcoKSArIGoudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgaHVtYW5HcmlkLmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL25vIHNoaXAgeWVzIGhpdFxuICAgICAgICAgICAgZWxzZSBpZihodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCA9PSBudWxsICYmIGh1bWFuLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmUtaGl0XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGh1bWFuR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy95ZXMgc2hpcCB5ZXMgaGl0XG4gICAgICAgICAgICBlbHNlIGlmKGh1bWFuLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5zaGlwICE9IG51bGwgJiYgaHVtYW4uZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLmlzSGl0ID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZS1zaGlwLWhpdFwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgaS50b1N0cmluZygpICsgai50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBodW1hbkdyaWQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvcHVsYXRlRW5lbXlCb2FyZCgpIHtcbiAgICBjbGVhckJvYXJkKGNvbXB1dGVyR3JpZCk7XG5cbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICAgICAgLy9ubyBzaGlwIG5vIGhpdFxuICAgICAgICAgICAgaWYoY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgPT0gbnVsbCAmJiBjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZVwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgaS50b1N0cmluZygpICsgai50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBjb21wdXRlckdyaWQuYXBwZW5kQ2hpbGQoc3F1YXJlKTsgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8veWVzIHNoaXAgbm8gaGl0IFxuICAgICAgICAgICAgLy9jb21wdXRlciBzaGlwIG11c3QgYmUgaW52aXNpYmxlIHRvIHRoZSBodW1hbiBwbGF5ZXIgYmVmb3JlIGJlaW5nIGhpdFxuICAgICAgICAgICAgZWxzZSBpZihjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCAhPSBudWxsICYmIGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlLXNoaXBcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImlkXCIsIGkudG9TdHJpbmcoKSArIGoudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgY29tcHV0ZXJHcmlkLmFwcGVuZENoaWxkKHNxdWFyZSk7IFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9ubyBzaGlwIHllcyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgPT0gbnVsbCAmJiBjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlLWhpdFwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgaS50b1N0cmluZygpICsgai50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBjb21wdXRlckdyaWQuYXBwZW5kQ2hpbGQoc3F1YXJlKTsgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3llcyBzaGlwIHllcyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgIT0gbnVsbCAmJiBjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlLXNoaXAtaGl0XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGNvbXB1dGVyR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpOyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxldCBjb21wdXRlclNxdWFyZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29tcHV0ZXItZ3JpZCA+IGRpdlwiKSk7XG5cbiAgICBjb21wdXRlclNxdWFyZXMuZm9yRWFjaChzcXVhcmUgPT4ge1xuICAgICAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrSGFuZGxlcik7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gY2xlYXJCb2FyZChib2FyZCkge1xuICAgIHdoaWxlKGJvYXJkLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgYm9hcmQucmVtb3ZlQ2hpbGQoYm9hcmQuZmlyc3RDaGlsZCk7XG4gICAgfVxufVxuXG5uZXdSb3VuZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuICAgIHdpbm5lclRleHQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHN0YXJ0R2FtZSgpO1xufSkiLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCB7IEFJIH0gZnJvbSBcIi4vYWlcIjtcbmltcG9ydCB7IHBvcHVsYXRlRW5lbXlCb2FyZCwgcG9wdWxhdGVQbGF5ZXJCb2FyZCB9IGZyb20gXCIuL2RvbVwiO1xuXG5leHBvcnQgbGV0IGh1bWFuID0gbmV3IFBsYXllcigpO1xuZXhwb3J0IGxldCBjb21wdXRlciA9IG5ldyBBSSgpO1xubGV0IG5ld1JvdW5kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXctcm91bmRcIik7XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGlja0hhbmRsZXIoZSkge1xuICAgIGxldCBjbGlja2VkID0gZS50YXJnZXQuaWQ7XG4gICAgbGV0IHggPSBjbGlja2VkWzBdO1xuICAgIGxldCB5ID0gY2xpY2tlZFsxXTtcbiAgICBpZihjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbeF1beV0uaXNIaXQgPT0gZmFsc2UpIHtcbiAgICAgICAgaHVtYW4udGFrZVR1cm4oY29tcHV0ZXIuZ2FtZWJvYXJkLCB4LCB5KVxuICAgICAgICBwb3B1bGF0ZUVuZW15Qm9hcmQoKTtcbiAgICAgICAgY29tcHV0ZXIudGFrZVR1cm5BSShodW1hbi5nYW1lYm9hcmQpO1xuICAgICAgICBwb3B1bGF0ZVBsYXllckJvYXJkKCk7IFxuICAgICAgICBjaGVja0ZvcldpbigpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hlY2tGb3JXaW4oKSB7XG4gICAgbGV0IGNvbXB1dGVyU3F1YXJlcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jb21wdXRlci1ncmlkID4gZGl2XCIpKTtcbiAgICBsZXQgd2lubmVyVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2lubmVyLXRleHQgPiBoMVwiKTtcblxuICAgIGlmKGNvbXB1dGVyLmdhbWVib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xuICAgICAgICB3aW5uZXJUZXh0LnRleHRDb250ZW50ID0gXCJZb3UgV2luIVwiXG4gICAgICAgIGNvbXB1dGVyU3F1YXJlcy5mb3JFYWNoKHNxdWFyZSA9PiB7XG4gICAgICAgICAgICBzcXVhcmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrSGFuZGxlcik7XG4gICAgICAgIH0pXG4gICAgICAgIG5ld1JvdW5kLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgfVxuICAgIGVsc2UgaWYoaHVtYW4uZ2FtZWJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XG4gICAgICAgIHdpbm5lclRleHQudGV4dENvbnRlbnQgPSBcIllvdSBMb3NlIVwiXG4gICAgICAgIGNvbXB1dGVyU3F1YXJlcy5mb3JFYWNoKHNxdWFyZSA9PiB7XG4gICAgICAgICAgICBzcXVhcmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrSGFuZGxlcik7XG4gICAgICAgIH0pXG4gICAgICAgIG5ld1JvdW5kLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRHYW1lKCkge1xuICAgIGh1bWFuLmdhbWVib2FyZC5yZXNldEJvYXJkKCk7XG4gICAgY29tcHV0ZXIuZ2FtZWJvYXJkLnJlc2V0Qm9hcmQoKTtcblxuICAgIG5ld1JvdW5kLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoMiwzLDUpO1xuICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoMCwxLDQpO1xuICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoNCw0LDMpO1xuICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoNiw3LDMpO1xuICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoOCwxLDIpO1xuXG4gICAgY29tcHV0ZXIucGxhY2VSYW5kb21TaGlwKDUpO1xuICAgIGNvbXB1dGVyLnBsYWNlUmFuZG9tU2hpcCg0KTtcbiAgICBjb21wdXRlci5wbGFjZVJhbmRvbVNoaXAoMyk7XG4gICAgY29tcHV0ZXIucGxhY2VSYW5kb21TaGlwKDMpO1xuICAgIGNvbXB1dGVyLnBsYWNlUmFuZG9tU2hpcCgyKTtcbiAgICBcbiAgICBwb3B1bGF0ZVBsYXllckJvYXJkKCk7XG4gICAgcG9wdWxhdGVFbmVteUJvYXJkKCk7XG59IiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vcGxheWVyXCI7XG5cbmV4cG9ydCBjbGFzcyBBSSBleHRlbmRzIFBsYXllciB7XG5cbiAgICBnZW5lcmF0ZUNvb3JkKCkge1xuICAgICAgICAvL3JhbmRvbSBudW1iZXIgYmV0d2VlbiAwIGFuZCA5XG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgfVxuXG4gICAgdGFrZVR1cm5BSShlbmVteUdhbWVib2FyZCkge1xuICAgICAgICBsZXQgeFBvcyA9IDA7XG4gICAgICAgIGxldCB5UG9zID0gMDtcbiAgICAgICAgbGV0IGtlZXBHb2luZyA9IHRydWU7XG5cbiAgICAgICAgd2hpbGUoa2VlcEdvaW5nKSB7XG4gICAgICAgICAgICB4UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICB5UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICBpZihlbmVteUdhbWVib2FyZC5ib2FyZFt4UG9zXVt5UG9zXS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGVuZW15R2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soeFBvcywgeVBvcyk7XG4gICAgICAgICAgICAgICAga2VlcEdvaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwbGFjZVJhbmRvbVNoaXAobGVuZ3RoKSB7XG4gICAgICAgIGxldCB4UG9zID0gMFxuICAgICAgICBsZXQgeVBvcyA9IDBcbiAgICAgICAgbGV0IGtlZXBHb2luZyA9IHRydWU7XG5cbiAgICAgICAgd2hpbGUoa2VlcEdvaW5nKSB7XG4gICAgICAgICAgICB4UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICB5UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICBpZih0aGlzLmdhbWVib2FyZC5wbGFjZVNoaXAoeFBvcywgeVBvcywgbGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIGtlZXBHb2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cbn0iLCJpbXBvcnQgeyBzdGFydEdhbWUgfSBmcm9tIFwiLi9nYW1lQ29udHJvbGxlclwiO1xuXG5zdGFydEdhbWUoKTsiXSwibmFtZXMiOlsiU2hpcCIsImNvbnN0cnVjdG9yIiwibGVuZ3RoIiwidGhpcyIsImhpdHMiLCJzdW5rIiwiX2xlbmd0aCIsImhpdCIsImlzU3VuayIsIkdhbWVib2FyZCIsImJvYXJkIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwic2hpcCIsImlzSGl0Iiwic2hpcHMiLCJyZXNldEJvYXJkIiwicGxhY2VTaGlwIiwieFBvcyIsInlQb3MiLCJuZXdTaGlwIiwiaSIsInB1c2giLCJyZWNlaXZlQXR0YWNrIiwiYWxsU2hpcHNTdW5rIiwiZXZlcnkiLCJQbGF5ZXIiLCJnYW1lYm9hcmQiLCJnZW5lcmF0ZUNvb3JkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidGFrZVR1cm4iLCJlbmVteUdhbWVib2FyZCIsInRha2VUdXJuQUkiLCJrZWVwR29pbmciLCJodW1hbkdyaWQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb21wdXRlckdyaWQiLCJuZXdSb3VuZCIsIndpbm5lclRleHQiLCJwb3B1bGF0ZVBsYXllckJvYXJkIiwiY2xlYXJCb2FyZCIsImoiLCJodW1hbiIsInNxdWFyZSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJ0b1N0cmluZyIsImFwcGVuZENoaWxkIiwicG9wdWxhdGVFbmVteUJvYXJkIiwiY29tcHV0ZXIiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiY2xpY2tIYW5kbGVyIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwiZSIsInRleHRDb250ZW50Iiwic3RhcnRHYW1lIiwicGxhY2VSYW5kb21TaGlwIiwiY2xpY2tlZCIsInRhcmdldCIsImlkIiwieCIsInkiLCJjb21wdXRlclNxdWFyZXMiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic3R5bGUiLCJkaXNwbGF5IiwiY2hlY2tGb3JXaW4iXSwic291cmNlUm9vdCI6IiJ9