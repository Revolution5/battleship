(()=>{"use strict";class e{constructor(e){this.length=e,this.hits=0,this.sunk=!1}get length(){return this._length}set length(e){this._length=e}hit(){this.hits+=1,this.isSunk()}isSunk(){this.hits==this.length&&(this.sunk=!0)}}class t{constructor(){this.board=[new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1})))],this.ships=[]}resetBoard(){this.board=[new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1}))),new Array(10).fill(null).map((()=>({ship:null,isHit:!1})))],this.ships=[]}placeShip(t,i,l){if(null==this.board[t][i].ship){let r=new e(l);this.ships.push(r);for(let e=i;e<i+l;e++)this.board[t][e].ship=r}}receiveAttack(e,t){null!=this.board[e][t].ship?(this.board[e][t].ship.hit(),this.board[e][t].isHit=!0):null==this.board[e][t].ship&&(this.board[e][t].isHit=!0)}allShipsSunk(){if(this.ships.every((e=>1==e.sunk)))return!0}}class i{constructor(){this.gameboard=new t}generateCoord(){return Math.floor(10*Math.random())}takeTurn(e,t,i){e.receiveAttack(t,i)}takeTurnAI(e){let t=0,i=0,l=!0;for(;l;)t=this.generateCoord(),i=this.generateCoord(),0==e.board[t][i].isHit&&(e.receiveAttack(t,i),l=!1)}}let l=document.querySelector(".human-grid"),r=document.querySelector(".computer-grid"),a=document.querySelector(".new-round"),n=document.querySelector(".winner-text > h1");function s(){d(l);for(let e=0;e<10;e++)for(let t=0;t<10;t++)if(null==u.gameboard.board[e][t].ship&&0==u.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square"),i.setAttribute("id",e.toString()+t.toString()),l.appendChild(i)}else if(null!=u.gameboard.board[e][t].ship&&0==u.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship"),i.setAttribute("id",e.toString()+t.toString()),l.appendChild(i)}else if(null==u.gameboard.board[e][t].ship&&1==u.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-hit"),i.setAttribute("id",e.toString()+t.toString()),l.appendChild(i)}else if(null!=u.gameboard.board[e][t].ship&&1==u.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship-hit"),i.setAttribute("id",e.toString()+t.toString()),l.appendChild(i)}}function o(){d(r);for(let e=0;e<10;e++)for(let t=0;t<10;t++)if(null==h.gameboard.board[e][t].ship&&0==h.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square"),i.setAttribute("id",e.toString()+t.toString()),r.appendChild(i)}else if(null!=h.gameboard.board[e][t].ship&&0==h.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square"),i.setAttribute("id",e.toString()+t.toString()),r.appendChild(i)}else if(null==h.gameboard.board[e][t].ship&&1==h.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-hit"),i.setAttribute("id",e.toString()+t.toString()),r.appendChild(i)}else if(null!=h.gameboard.board[e][t].ship&&1==h.gameboard.board[e][t].isHit){let i=document.createElement("div");i.classList.add("square-ship-hit"),i.setAttribute("id",e.toString()+t.toString()),r.appendChild(i)}Array.from(document.querySelectorAll(".computer-grid > div")).forEach((e=>{e.addEventListener("click",c)}))}function d(e){for(;e.firstChild;)e.removeChild(e.firstChild)}a.addEventListener("click",(function(e){n.textContent="",m()}));let u=new i,h=new class extends i{generateCoord(){return Math.floor(10*Math.random())}takeTurnAI(e){let t=0,i=0,l=!0;for(;l;)t=this.generateCoord(),i=this.generateCoord(),0==e.board[t][i].isHit&&(e.receiveAttack(t,i),l=!1)}},p=document.querySelector(".new-round");function c(e){let t=e.target.id,i=t[0],l=t[1];0==h.gameboard.board[i][l].isHit&&(u.takeTurn(h.gameboard,i,l),o(),h.takeTurnAI(u.gameboard),s(),function(){let e=Array.from(document.querySelectorAll(".computer-grid > div")),t=document.querySelector(".winner-text > h1");h.gameboard.allShipsSunk()?(t.textContent="You Win!",e.forEach((e=>{e.removeEventListener("click",c)})),p.style.display="block"):u.gameboard.allShipsSunk()&&(t.textContent="You Lose!",e.forEach((e=>{e.removeEventListener("click",c)})),p.style.display="block")}())}function m(){u.gameboard.resetBoard(),h.gameboard.resetBoard(),p.style.display="none",u.gameboard.placeShip(2,3,5),u.gameboard.placeShip(0,1,4),u.gameboard.placeShip(4,4,3),u.gameboard.placeShip(6,7,3),u.gameboard.placeShip(8,1,2),h.gameboard.placeShip(0,1,2),s(),o()}m()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2xCaUIsRUFBV3NCLFlBQWMsV0FDekJPLEVBQWdCYixTQUFRWCxJQUNwQkEsRUFBT3lCLG9CQUFvQixRQUFTWixNQUV4QyxFQUFTYSxNQUFNQyxRQUFVLFNBRXJCNUIsRUFBTWxCLFVBQVVILGlCQUNwQmlCLEVBQVdzQixZQUFjLFlBQ3pCTyxFQUFnQmIsU0FBUVgsSUFDcEJBLEVBQU95QixvQkFBb0IsUUFBU1osTUFFeEMsRUFBU2EsTUFBTUMsUUFBVSxTQXBCekJDLElBd0JELFNBQVNWLElBQ1puQixFQUFNbEIsVUFBVVgsYUFDaEJzQyxFQUFTM0IsVUFBVVgsYUFDbkIsRUFBU3dELE1BQU1DLFFBQVUsT0FDekI1QixFQUFNbEIsVUFBVVYsVUFBVSxFQUFFLEVBQUUsR0FDOUI0QixFQUFNbEIsVUFBVVYsVUFBVSxFQUFFLEVBQUUsR0FDOUI0QixFQUFNbEIsVUFBVVYsVUFBVSxFQUFFLEVBQUUsR0FDOUI0QixFQUFNbEIsVUFBVVYsVUFBVSxFQUFFLEVBQUUsR0FDOUI0QixFQUFNbEIsVUFBVVYsVUFBVSxFQUFFLEVBQUUsR0FFOUJxQyxFQUFTM0IsVUFBVVYsVUFBVSxFQUFFLEVBQUUsR0FFakN5QixJQUNBVyxJRXBESlcsSyIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2RvbS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVDb250cm9sbGVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvYWkuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgU2hpcCB7XG4gICAgY29uc3RydWN0b3IobGVuZ3RoKSB7XG4gICAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgICB0aGlzLmhpdHMgPSAwO1xuICAgICAgICB0aGlzLnN1bmsgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBnZXQgbGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGVuZ3RoO1xuICAgIH1cblxuICAgIHNldCBsZW5ndGgobGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuX2xlbmd0aCA9IGxlbmd0aDtcbiAgICB9XG5cbiAgICBoaXQoKSB7XG4gICAgICAgIHRoaXMuaGl0cyArPSAxO1xuICAgICAgICB0aGlzLmlzU3VuaygpO1xuICAgIH1cblxuICAgIGlzU3VuaygpIHtcbiAgICAgICAgaWYodGhpcy5oaXRzID09IHRoaXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnN1bmsgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcblxuZXhwb3J0IGNsYXNzIEdhbWVib2FyZCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpXG4gICAgICAgIF1cblxuICAgICAgICB0aGlzLnNoaXBzID0gW11cbiAgICB9XG5cbiAgICByZXNldEJvYXJkKCkge1xuICAgICAgICB0aGlzLmJvYXJkID0gW1xuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKSxcbiAgICAgICAgICAgIG5ldyBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoKCkgPT4gKHtzaGlwOiBudWxsLCBpc0hpdDogZmFsc2V9KSksXG4gICAgICAgICAgICBuZXcgQXJyYXkoMTApLmZpbGwobnVsbCkubWFwKCgpID0+ICh7c2hpcDogbnVsbCwgaXNIaXQ6IGZhbHNlfSkpLFxuICAgICAgICAgICAgbmV3IEFycmF5KDEwKS5maWxsKG51bGwpLm1hcCgoKSA9PiAoe3NoaXA6IG51bGwsIGlzSGl0OiBmYWxzZX0pKVxuICAgICAgICBdXG5cbiAgICAgICAgdGhpcy5zaGlwcyA9IFtdXG4gICAgfVxuXG4gICAgcGxhY2VTaGlwKHhQb3MsIHlQb3MsIGxlbmd0aCkge1xuICAgICAgICBpZih0aGlzLmJvYXJkW3hQb3NdW3lQb3NdLnNoaXAgPT0gbnVsbCkge1xuICAgICAgICAgICAgbGV0IG5ld1NoaXAgPSBuZXcgU2hpcChsZW5ndGgpO1xuICAgICAgICAgICAgdGhpcy5zaGlwcy5wdXNoKG5ld1NoaXApO1xuICAgICAgICAgICAgLy9ob3Jpem9udGFsIHNoaXBcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IHlQb3M7IGkgPCB5UG9zICsgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW3hQb3NdW2ldLnNoaXAgPSBuZXdTaGlwOyAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVjZWl2ZUF0dGFjayh4UG9zLCB5UG9zKSB7XG4gICAgICAgIC8vaWYgdGhlIHNxdWFyZSBoYXMgYSBzaGlwIG9uIGl0XG4gICAgICAgIGlmKHRoaXMuYm9hcmRbeFBvc11beVBvc10uc2hpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmJvYXJkW3hQb3NdW3lQb3NdLnNoaXAuaGl0KCk7XG4gICAgICAgICAgICB0aGlzLmJvYXJkW3hQb3NdW3lQb3NdLmlzSGl0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICAvL2lmIHRoZXJlIHNxdWFyZSBkb2VzIG5vdCBoYXZlIGEgc2hpcCBvbiBpdFxuICAgICAgICBlbHNlIGlmKHRoaXMuYm9hcmRbeFBvc11beVBvc10uc2hpcCA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmJvYXJkW3hQb3NdW3lQb3NdLmlzSGl0ID0gdHJ1ZTsgICBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFsbFNoaXBzU3VuaygpIHtcbiAgICAgICAgaWYodGhpcy5zaGlwcy5ldmVyeShzaGlwID0+IHNoaXAuc3VuayA9PSB0cnVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG59IiwiaW1wb3J0IHsgR2FtZWJvYXJkIH0gZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5cbmV4cG9ydCBjbGFzcyBQbGF5ZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmdhbWVib2FyZCA9IG5ldyBHYW1lYm9hcmQ7XG4gICAgfVxuXG4gICAgZ2VuZXJhdGVDb29yZCgpIHtcbiAgICAgICAgLy9yYW5kb20gbnVtYmVyIGJldHdlZW4gMCBhbmQgOVxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIH1cblxuICAgIHRha2VUdXJuKGVuZW15R2FtZWJvYXJkLCB4UG9zLCB5UG9zKSB7XG4gICAgICAgIGVuZW15R2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soeFBvcywgeVBvcyk7IFxuICAgIH1cblxuICAgIHRha2VUdXJuQUkoZW5lbXlHYW1lYm9hcmQpIHtcbiAgICAgICAgbGV0IHhQb3MgPSAwO1xuICAgICAgICBsZXQgeVBvcyA9IDA7XG4gICAgICAgIGxldCBrZWVwR29pbmcgPSB0cnVlO1xuXG4gICAgICAgIHdoaWxlKGtlZXBHb2luZykge1xuICAgICAgICAgICAgeFBvcyA9IHRoaXMuZ2VuZXJhdGVDb29yZCgpO1xuICAgICAgICAgICAgeVBvcyA9IHRoaXMuZ2VuZXJhdGVDb29yZCgpO1xuICAgICAgICAgICAgaWYoZW5lbXlHYW1lYm9hcmQuYm9hcmRbeFBvc11beVBvc10uaXNIaXQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBlbmVteUdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKHhQb3MsIHlQb3MpO1xuICAgICAgICAgICAgICAgIGtlZXBHb2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSIsImltcG9ydCB7IGh1bWFuLCBjb21wdXRlciwgY2xpY2tIYW5kbGVyLCBzdGFydEdhbWUgfSBmcm9tIFwiLi9nYW1lQ29udHJvbGxlclwiO1xuXG5sZXQgaHVtYW5HcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5odW1hbi1ncmlkXCIpO1xubGV0IGNvbXB1dGVyR3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcHV0ZXItZ3JpZFwiKTtcbmxldCBuZXdSb3VuZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXJvdW5kXCIpO1xubGV0IHdpbm5lclRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndpbm5lci10ZXh0ID4gaDFcIik7XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3B1bGF0ZVBsYXllckJvYXJkKCkge1xuICAgIGNsZWFyQm9hcmQoaHVtYW5HcmlkKTtcblxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgICAgICAvL25vIHNoaXAgbm8gaGl0XG4gICAgICAgICAgICBpZihodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCA9PSBudWxsICYmIGh1bWFuLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlXCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGh1bWFuR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpOyAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy95ZXMgc2hpcCBubyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoaHVtYW4uZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgIT0gbnVsbCAmJiBodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZS1zaGlwXCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGh1bWFuR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9ubyBzaGlwIHllcyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoaHVtYW4uZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgPT0gbnVsbCAmJiBodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlLWhpdFwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgaS50b1N0cmluZygpICsgai50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBodW1hbkdyaWQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8veWVzIHNoaXAgeWVzIGhpdFxuICAgICAgICAgICAgZWxzZSBpZihodW1hbi5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCAhPSBudWxsICYmIGh1bWFuLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmUtc2hpcC1oaXRcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImlkXCIsIGkudG9TdHJpbmcoKSArIGoudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgaHVtYW5HcmlkLmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3B1bGF0ZUVuZW15Qm9hcmQoKSB7XG4gICAgY2xlYXJCb2FyZChjb21wdXRlckdyaWQpO1xuXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgICAgIC8vbm8gc2hpcCBubyBoaXRcbiAgICAgICAgICAgIGlmKGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5zaGlwID09IG51bGwgJiYgY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLmlzSGl0ID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImlkXCIsIGkudG9TdHJpbmcoKSArIGoudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgY29tcHV0ZXJHcmlkLmFwcGVuZENoaWxkKHNxdWFyZSk7ICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3llcyBzaGlwIG5vIGhpdCBcbiAgICAgICAgICAgIC8vY29tcHV0ZXIgc2hpcCBtdXN0IGJlIGludmlzaWJsZSB0byB0aGUgaHVtYW4gcGxheWVyIGJlZm9yZSBiZWluZyBoaXRcbiAgICAgICAgICAgIGVsc2UgaWYoY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgIT0gbnVsbCAmJiBjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZVwiKTtcbiAgICAgICAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgaS50b1N0cmluZygpICsgai50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBjb21wdXRlckdyaWQuYXBwZW5kQ2hpbGQoc3F1YXJlKTsgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL25vIHNoaXAgeWVzIGhpdFxuICAgICAgICAgICAgZWxzZSBpZihjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCA9PSBudWxsICYmIGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmUtaGl0XCIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpLnRvU3RyaW5nKCkgKyBqLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGNvbXB1dGVyR3JpZC5hcHBlbmRDaGlsZChzcXVhcmUpOyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8veWVzIHNoaXAgeWVzIGhpdFxuICAgICAgICAgICAgZWxzZSBpZihjb21wdXRlci5nYW1lYm9hcmQuYm9hcmRbaV1bal0uc2hpcCAhPSBudWxsICYmIGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZFtpXVtqXS5pc0hpdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmUtc2hpcC1oaXRcIik7XG4gICAgICAgICAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImlkXCIsIGkudG9TdHJpbmcoKSArIGoudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgY29tcHV0ZXJHcmlkLmFwcGVuZENoaWxkKHNxdWFyZSk7IFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbGV0IGNvbXB1dGVyU3F1YXJlcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jb21wdXRlci1ncmlkID4gZGl2XCIpKTtcblxuICAgIGNvbXB1dGVyU3F1YXJlcy5mb3JFYWNoKHNxdWFyZSA9PiB7XG4gICAgICAgIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2tIYW5kbGVyKTtcbiAgICB9KVxufVxuXG5mdW5jdGlvbiBjbGVhckJvYXJkKGJvYXJkKSB7XG4gICAgd2hpbGUoYm9hcmQuZmlyc3RDaGlsZCkge1xuICAgICAgICBib2FyZC5yZW1vdmVDaGlsZChib2FyZC5maXJzdENoaWxkKTtcbiAgICB9XG59XG5cbm5ld1JvdW5kLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XG4gICAgd2lubmVyVGV4dC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgc3RhcnRHYW1lKCk7XG59KSIsImltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IHsgQUkgfSBmcm9tIFwiLi9haVwiO1xuaW1wb3J0IHsgcG9wdWxhdGVFbmVteUJvYXJkLCBwb3B1bGF0ZVBsYXllckJvYXJkIH0gZnJvbSBcIi4vZG9tXCI7XG5cbmV4cG9ydCBsZXQgaHVtYW4gPSBuZXcgUGxheWVyKCk7XG5leHBvcnQgbGV0IGNvbXB1dGVyID0gbmV3IEFJKCk7XG5sZXQgbmV3Um91bmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm5ldy1yb3VuZFwiKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNsaWNrSGFuZGxlcihlKSB7XG4gICAgbGV0IGNsaWNrZWQgPSBlLnRhcmdldC5pZDtcbiAgICBsZXQgeCA9IGNsaWNrZWRbMF07XG4gICAgbGV0IHkgPSBjbGlja2VkWzFdO1xuICAgIGlmKGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZFt4XVt5XS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICBodW1hbi50YWtlVHVybihjb21wdXRlci5nYW1lYm9hcmQsIHgsIHkpXG4gICAgICAgIHBvcHVsYXRlRW5lbXlCb2FyZCgpO1xuICAgICAgICBjb21wdXRlci50YWtlVHVybkFJKGh1bWFuLmdhbWVib2FyZCk7XG4gICAgICAgIHBvcHVsYXRlUGxheWVyQm9hcmQoKTsgXG4gICAgICAgIGNoZWNrRm9yV2luKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjaGVja0ZvcldpbigpIHtcbiAgICBsZXQgY29tcHV0ZXJTcXVhcmVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNvbXB1dGVyLWdyaWQgPiBkaXZcIikpO1xuICAgIGxldCB3aW5uZXJUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aW5uZXItdGV4dCA+IGgxXCIpO1xuXG4gICAgaWYoY29tcHV0ZXIuZ2FtZWJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XG4gICAgICAgIHdpbm5lclRleHQudGV4dENvbnRlbnQgPSBcIllvdSBXaW4hXCJcbiAgICAgICAgY29tcHV0ZXJTcXVhcmVzLmZvckVhY2goc3F1YXJlID0+IHtcbiAgICAgICAgICAgIHNxdWFyZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2tIYW5kbGVyKTtcbiAgICAgICAgfSlcbiAgICAgICAgbmV3Um91bmQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICB9XG4gICAgZWxzZSBpZihodW1hbi5nYW1lYm9hcmQuYWxsU2hpcHNTdW5rKCkpIHtcbiAgICAgICAgd2lubmVyVGV4dC50ZXh0Q29udGVudCA9IFwiWW91IExvc2UhXCJcbiAgICAgICAgY29tcHV0ZXJTcXVhcmVzLmZvckVhY2goc3F1YXJlID0+IHtcbiAgICAgICAgICAgIHNxdWFyZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2tIYW5kbGVyKTtcbiAgICAgICAgfSlcbiAgICAgICAgbmV3Um91bmQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdGFydEdhbWUoKSB7XG4gICAgaHVtYW4uZ2FtZWJvYXJkLnJlc2V0Qm9hcmQoKTtcbiAgICBjb21wdXRlci5nYW1lYm9hcmQucmVzZXRCb2FyZCgpO1xuICAgIG5ld1JvdW5kLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKDIsMyw1KTtcbiAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKDAsMSw0KTtcbiAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKDQsNCwzKTtcbiAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKDYsNywzKTtcbiAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKDgsMSwyKTtcblxuICAgIGNvbXB1dGVyLmdhbWVib2FyZC5wbGFjZVNoaXAoMCwxLDIpO1xuICAgIFxuICAgIHBvcHVsYXRlUGxheWVyQm9hcmQoKTtcbiAgICBwb3B1bGF0ZUVuZW15Qm9hcmQoKTtcbn0iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcblxuZXhwb3J0IGNsYXNzIEFJIGV4dGVuZHMgUGxheWVyIHtcbiAgICBcbiAgICBnZW5lcmF0ZUNvb3JkKCkge1xuICAgICAgICAvL3JhbmRvbSBudW1iZXIgYmV0d2VlbiAwIGFuZCA5XG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgfVxuXG4gICAgdGFrZVR1cm5BSShlbmVteUdhbWVib2FyZCkge1xuICAgICAgICBsZXQgeFBvcyA9IDA7XG4gICAgICAgIGxldCB5UG9zID0gMDtcbiAgICAgICAgbGV0IGtlZXBHb2luZyA9IHRydWU7XG5cbiAgICAgICAgd2hpbGUoa2VlcEdvaW5nKSB7XG4gICAgICAgICAgICB4UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICB5UG9zID0gdGhpcy5nZW5lcmF0ZUNvb3JkKCk7XG4gICAgICAgICAgICBpZihlbmVteUdhbWVib2FyZC5ib2FyZFt4UG9zXVt5UG9zXS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGVuZW15R2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soeFBvcywgeVBvcyk7XG4gICAgICAgICAgICAgICAga2VlcEdvaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59IiwiaW1wb3J0IHsgc3RhcnRHYW1lIH0gZnJvbSBcIi4vZ2FtZUNvbnRyb2xsZXJcIjtcblxuc3RhcnRHYW1lKCk7Il0sIm5hbWVzIjpbIlNoaXAiLCJjb25zdHJ1Y3RvciIsImxlbmd0aCIsInRoaXMiLCJoaXRzIiwic3VuayIsIl9sZW5ndGgiLCJoaXQiLCJpc1N1bmsiLCJHYW1lYm9hcmQiLCJib2FyZCIsIkFycmF5IiwiZmlsbCIsIm1hcCIsInNoaXAiLCJpc0hpdCIsInNoaXBzIiwicmVzZXRCb2FyZCIsInBsYWNlU2hpcCIsInhQb3MiLCJ5UG9zIiwibmV3U2hpcCIsInB1c2giLCJpIiwicmVjZWl2ZUF0dGFjayIsImFsbFNoaXBzU3VuayIsImV2ZXJ5IiwiUGxheWVyIiwiZ2FtZWJvYXJkIiwiZ2VuZXJhdGVDb29yZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInRha2VUdXJuIiwiZW5lbXlHYW1lYm9hcmQiLCJ0YWtlVHVybkFJIiwia2VlcEdvaW5nIiwiaHVtYW5HcmlkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29tcHV0ZXJHcmlkIiwibmV3Um91bmQiLCJ3aW5uZXJUZXh0IiwicG9wdWxhdGVQbGF5ZXJCb2FyZCIsImNsZWFyQm9hcmQiLCJqIiwiaHVtYW4iLCJzcXVhcmUiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwidG9TdHJpbmciLCJhcHBlbmRDaGlsZCIsInBvcHVsYXRlRW5lbXlCb2FyZCIsImNvbXB1dGVyIiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsaWNrSGFuZGxlciIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsImUiLCJ0ZXh0Q29udGVudCIsInN0YXJ0R2FtZSIsImNsaWNrZWQiLCJ0YXJnZXQiLCJpZCIsIngiLCJ5IiwiY29tcHV0ZXJTcXVhcmVzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInN0eWxlIiwiZGlzcGxheSIsImNoZWNrRm9yV2luIl0sInNvdXJjZVJvb3QiOiIifQ==